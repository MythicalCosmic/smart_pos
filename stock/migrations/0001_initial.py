# Generated by Django 5.2.8 on 2026-02-09 19:44

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('main', '0020_cashregister_branch_id_cashregister_is_deleted_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='StockAlertConfig',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('alert_type', models.CharField(choices=[('LOW_STOCK', 'Low Stock'), ('EXPIRING', 'Expiring'), ('NEGATIVE', 'Negative Stock'), ('OVERSTOCK', 'Overstock')], max_length=20)),
                ('notify_email', models.BooleanField(default=False)),
                ('notify_telegram', models.BooleanField(default=True)),
                ('notify_in_app', models.BooleanField(default=True)),
                ('threshold_value', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name='Supplier',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('code', models.CharField(blank=True, max_length=20, null=True, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('legal_name', models.CharField(blank=True, default='', max_length=200)),
                ('contact_person', models.CharField(blank=True, default='', max_length=100)),
                ('email', models.EmailField(blank=True, default='', max_length=254)),
                ('phone', models.CharField(blank=True, default='', max_length=50)),
                ('mobile', models.CharField(blank=True, default='', max_length=50)),
                ('address', models.TextField(blank=True, default='')),
                ('city', models.CharField(blank=True, default='', max_length=100)),
                ('country', models.CharField(blank=True, default='', max_length=100)),
                ('tax_id', models.CharField(blank=True, default='', max_length=50)),
                ('payment_terms_days', models.PositiveIntegerField(default=30)),
                ('credit_limit', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('current_balance', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('currency', models.CharField(default='UZS', max_length=3)),
                ('lead_time_days', models.PositiveIntegerField(default=1)),
                ('minimum_order_value', models.DecimalField(blank=True, decimal_places=2, max_digits=15, null=True)),
                ('rating', models.PositiveSmallIntegerField(blank=True, help_text='1 to 5', null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='VarianceReasonCode',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('code', models.CharField(max_length=20, unique=True)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True, default='')),
                ('requires_approval', models.BooleanField(default=False)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
        ),
        migrations.CreateModel(
            name='PurchaseOrder',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('order_number', models.CharField(max_length=50, unique=True)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('SENT', 'Sent'), ('CONFIRMED', 'Confirmed'), ('PARTIAL', 'Partially Received'), ('RECEIVED', 'Received'), ('CANCELLED', 'Cancelled')], default='DRAFT', max_length=20)),
                ('order_date', models.DateField()),
                ('expected_date', models.DateField(blank=True, null=True)),
                ('received_date', models.DateField(blank=True, null=True)),
                ('subtotal', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('tax_amount', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('shipping_cost', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('discount', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('total', models.DecimalField(decimal_places=2, default=0, max_digits=15)),
                ('currency', models.CharField(default='UZS', max_length=3)),
                ('payment_status', models.CharField(choices=[('UNPAID', 'Unpaid'), ('PARTIAL', 'Partial'), ('PAID', 'Paid')], default='UNPAID', max_length=20)),
                ('payment_due_date', models.DateField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_purchase_orders', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='created_purchase_orders', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-order_date'],
            },
        ),
        migrations.CreateModel(
            name='Recipe',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('code', models.CharField(blank=True, max_length=50, null=True, unique=True)),
                ('output_quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('recipe_type', models.CharField(choices=[('PRODUCTION', 'Production'), ('ASSEMBLY', 'Assembly'), ('PREPARATION', 'Preparation'), ('DISASSEMBLY', 'Disassembly')], max_length=20)),
                ('version', models.PositiveIntegerField(default=1)),
                ('is_active_version', models.BooleanField(default=True)),
                ('yield_percentage', models.DecimalField(decimal_places=2, default=100, max_digits=5)),
                ('estimated_time_minutes', models.PositiveIntegerField(blank=True, null=True)),
                ('difficulty_level', models.PositiveSmallIntegerField(default=1, help_text='1 (easy) to 5 (hard)')),
                ('instructions', models.TextField(blank=True, default='')),
                ('notes', models.TextField(blank=True, default='')),
                ('is_scalable', models.BooleanField(default=True)),
                ('min_batch_size', models.DecimalField(decimal_places=4, default=1, max_digits=15)),
                ('max_batch_size', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_recipes', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_recipes', to=settings.AUTH_USER_MODEL)),
                ('parent_recipe', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='versions', to='stock.recipe')),
            ],
            options={
                'ordering': ['name', '-version'],
            },
        ),
        migrations.CreateModel(
            name='ProductionOrder',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('order_number', models.CharField(max_length=50, unique=True)),
                ('batch_multiplier', models.DecimalField(decimal_places=4, default=1, max_digits=10)),
                ('expected_output_qty', models.DecimalField(decimal_places=4, max_digits=15)),
                ('actual_output_qty', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('PLANNED', 'Planned'), ('IN_PROGRESS', 'In Progress'), ('COMPLETED', 'Completed'), ('CANCELLED', 'Cancelled'), ('ON_HOLD', 'On Hold')], default='DRAFT', max_length=20)),
                ('priority', models.CharField(choices=[('LOW', 'Low'), ('NORMAL', 'Normal'), ('HIGH', 'High'), ('URGENT', 'Urgent')], default='NORMAL', max_length=10)),
                ('planned_start', models.DateTimeField(blank=True, null=True)),
                ('planned_end', models.DateTimeField(blank=True, null=True)),
                ('actual_start', models.DateTimeField(blank=True, null=True)),
                ('actual_end', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_production_orders', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='created_production_orders', to=settings.AUTH_USER_MODEL)),
                ('recipe', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='production_orders', to='stock.recipe')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='RecipeStep',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('step_number', models.PositiveIntegerField()),
                ('title', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True, default='')),
                ('duration_minutes', models.PositiveIntegerField(blank=True, null=True)),
                ('temperature', models.CharField(blank=True, default='', max_length=50)),
                ('equipment_needed', models.TextField(blank=True, default='')),
                ('is_checkpoint', models.BooleanField(default=False)),
                ('photo_url', models.URLField(blank=True, default='', max_length=500)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('recipe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='steps', to='stock.recipe')),
            ],
            options={
                'ordering': ['step_number'],
                'unique_together': {('recipe', 'step_number')},
            },
        ),
        migrations.CreateModel(
            name='ProductionOrderStep',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('IN_PROGRESS', 'In Progress'), ('COMPLETED', 'Completed'), ('SKIPPED', 'Skipped')], default='PENDING', max_length=20)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('checkpoint_passed', models.BooleanField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('completed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('production_order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='steps', to='stock.productionorder')),
                ('recipe_step', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.recipestep')),
            ],
        ),
        migrations.CreateModel(
            name='StockCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('name', models.CharField(max_length=100)),
                ('type', models.CharField(choices=[('RAW_MATERIAL', 'Raw Material'), ('SEMI_FINISHED', 'Semi-Finished'), ('FINISHED_GOOD', 'Finished Good'), ('PACKAGING', 'Packaging'), ('CONSUMABLE', 'Consumable')], max_length=20)),
                ('sort_order', models.PositiveIntegerField(default=0)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('parent', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='children', to='stock.stockcategory')),
            ],
            options={
                'verbose_name_plural': 'stock categories',
                'ordering': ['sort_order', 'name'],
            },
        ),
        migrations.CreateModel(
            name='StockItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('sku', models.CharField(blank=True, max_length=50, null=True, unique=True)),
                ('barcode', models.CharField(blank=True, db_index=True, max_length=100, null=True)),
                ('item_type', models.CharField(choices=[('RAW', 'Raw Material'), ('SEMI', 'Semi-Finished'), ('FINISHED', 'Finished Good'), ('PACKAGING', 'Packaging')], max_length=20)),
                ('min_stock_level', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('max_stock_level', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('reorder_point', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('cost_price', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('avg_cost_price', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('last_cost_price', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('is_purchasable', models.BooleanField(default=True)),
                ('is_sellable', models.BooleanField(default=False)),
                ('is_producible', models.BooleanField(default=False)),
                ('track_batches', models.BooleanField(default=False)),
                ('track_expiry', models.BooleanField(default=False)),
                ('default_expiry_days', models.PositiveIntegerField(blank=True, null=True)),
                ('storage_conditions', models.TextField(blank=True, default='')),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('category', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='items', to='stock.stockcategory')),
            ],
            options={
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='RecipeIngredient',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('is_optional', models.BooleanField(default=False)),
                ('is_scalable', models.BooleanField(default=True)),
                ('waste_percentage', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('prep_instructions', models.TextField(blank=True, default='')),
                ('sort_order', models.PositiveIntegerField(default=0)),
                ('substitute_group', models.CharField(blank=True, default='', max_length=50)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('recipe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ingredients', to='stock.recipe')),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='used_in_recipes', to='stock.stockitem')),
            ],
            options={
                'ordering': ['sort_order'],
            },
        ),
        migrations.AddField(
            model_name='recipe',
            name='output_item',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='recipes_as_output', to='stock.stockitem'),
        ),
        migrations.CreateModel(
            name='PurchaseOrderItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('quantity_ordered', models.DecimalField(decimal_places=4, max_digits=15)),
                ('quantity_received', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('unit_price', models.DecimalField(decimal_places=4, max_digits=15)),
                ('discount_percent', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('tax_percent', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('total_price', models.DecimalField(decimal_places=4, max_digits=15)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('purchase_order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='stock.purchaseorder')),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockitem')),
            ],
        ),
        migrations.CreateModel(
            name='StockLocation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('name', models.CharField(max_length=100)),
                ('type', models.CharField(choices=[('WAREHOUSE', 'Warehouse'), ('KITCHEN', 'Kitchen'), ('BAR', 'Bar'), ('STORAGE', 'Storage'), ('PREP', 'Prep Area')], max_length=20)),
                ('is_default', models.BooleanField(default=False)),
                ('is_production_area', models.BooleanField(default=False)),
                ('is_active', models.BooleanField(default=True)),
                ('sort_order', models.PositiveIntegerField(default=0)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('parent_location', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='children', to='stock.stocklocation')),
            ],
            options={
                'ordering': ['sort_order', 'name'],
            },
        ),
        migrations.CreateModel(
            name='StockCount',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('count_number', models.CharField(max_length=50, unique=True)),
                ('count_type', models.CharField(choices=[('FULL', 'Full Count'), ('PARTIAL', 'Partial Count'), ('CYCLE', 'Cycle Count'), ('SPOT', 'Spot Check')], max_length=20)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('IN_PROGRESS', 'In Progress'), ('PENDING_APPROVAL', 'Pending Approval'), ('APPROVED', 'Approved'), ('CANCELLED', 'Cancelled')], default='DRAFT', max_length=20)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('auto_adjust', models.BooleanField(default=False)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_stock_counts', to=settings.AUTH_USER_MODEL)),
                ('category_filter', models.ForeignKey(blank=True, help_text='If set, only items in this category will be counted', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.stockcategory')),
                ('counted_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='stock_counts', to=settings.AUTH_USER_MODEL)),
                ('location', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='stock_counts', to='stock.stocklocation')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='StockBatch',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('batch_number', models.CharField(max_length=100)),
                ('initial_quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('current_quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('reserved_quantity', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('unit_cost', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('total_cost', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('manufactured_date', models.DateField(blank=True, null=True)),
                ('expiry_date', models.DateField(blank=True, db_index=True, null=True)),
                ('status', models.CharField(choices=[('AVAILABLE', 'Available'), ('RESERVED', 'Reserved'), ('QUARANTINE', 'Quarantine'), ('EXPIRED', 'Expired'), ('CONSUMED', 'Consumed')], default='AVAILABLE', max_length=20)),
                ('quality_status', models.CharField(default='PASSED', max_length=20)),
                ('notes', models.TextField(blank=True, default='')),
                ('received_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('production_order', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='output_batches', to='stock.productionorder')),
                ('purchase_order', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='batches', to='stock.purchaseorder')),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='batches', to='stock.stockitem')),
                ('location', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='batches', to='stock.stocklocation')),
                ('supplier', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='batches', to='stock.supplier')),
            ],
            options={
                'verbose_name_plural': 'stock batches',
            },
        ),
        migrations.AddField(
            model_name='recipe',
            name='production_location',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='recipes', to='stock.stocklocation'),
        ),
        migrations.CreateModel(
            name='PurchaseReceiving',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('receiving_number', models.CharField(max_length=50, unique=True)),
                ('received_date', models.DateField()),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('COMPLETED', 'Completed')], default='DRAFT', max_length=20)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('purchase_order', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='receivings', to='stock.purchaseorder')),
                ('received_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('location', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stocklocation')),
            ],
        ),
        migrations.AddField(
            model_name='purchaseorder',
            name='delivery_location',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='purchase_orders', to='stock.stocklocation'),
        ),
        migrations.AddField(
            model_name='productionorder',
            name='output_location',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='production_orders_output', to='stock.stocklocation'),
        ),
        migrations.AddField(
            model_name='productionorder',
            name='source_location',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='production_orders_source', to='stock.stocklocation'),
        ),
        migrations.CreateModel(
            name='StockSettings',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('stock_enabled', models.BooleanField(default=False)),
                ('production_enabled', models.BooleanField(default=False)),
                ('purchasing_enabled', models.BooleanField(default=False)),
                ('multi_location_enabled', models.BooleanField(default=False)),
                ('track_cost', models.BooleanField(default=True)),
                ('track_batches', models.BooleanField(default=False)),
                ('track_expiry', models.BooleanField(default=False)),
                ('track_serial_numbers', models.BooleanField(default=False)),
                ('allow_negative_stock', models.BooleanField(default=False)),
                ('auto_deduct_on_sale', models.BooleanField(default=True)),
                ('deduct_on_order_status', models.CharField(default='PREPARING', max_length=20)),
                ('reserve_on_order_create', models.BooleanField(default=False)),
                ('auto_create_production', models.BooleanField(default=False)),
                ('costing_method', models.CharField(choices=[('FIFO', 'First In, First Out'), ('LIFO', 'Last In, First Out'), ('AVERAGE', 'Weighted Average'), ('SPECIFIC', 'Specific Identification')], default='FIFO', max_length=20)),
                ('include_waste_in_cost', models.BooleanField(default=True)),
                ('low_stock_alert_enabled', models.BooleanField(default=True)),
                ('expiry_alert_enabled', models.BooleanField(default=True)),
                ('expiry_alert_days', models.PositiveIntegerField(default=7)),
                ('negative_stock_alert', models.BooleanField(default=True)),
                ('require_po_approval', models.BooleanField(default=False)),
                ('require_transfer_approval', models.BooleanField(default=False)),
                ('require_adjustment_approval', models.BooleanField(default=False)),
                ('require_count_approval', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('default_location', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.stocklocation')),
                ('default_production_location', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.stocklocation')),
                ('default_receiving_location', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.stocklocation')),
            ],
            options={
                'verbose_name': 'stock settings',
                'verbose_name_plural': 'stock settings',
            },
        ),
        migrations.CreateModel(
            name='StockTransfer',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('transfer_number', models.CharField(max_length=50, unique=True)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('REQUESTED', 'Requested'), ('APPROVED', 'Approved'), ('IN_TRANSIT', 'In Transit'), ('RECEIVED', 'Received'), ('CANCELLED', 'Cancelled')], default='DRAFT', max_length=20)),
                ('transfer_type', models.CharField(choices=[('INTERNAL', 'Internal'), ('BRANCH_TO_BRANCH', 'Branch to Branch')], default='INTERNAL', max_length=20)),
                ('requested_at', models.DateTimeField(blank=True, null=True)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('shipped_at', models.DateTimeField(blank=True, null=True)),
                ('received_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_transfers', to=settings.AUTH_USER_MODEL)),
                ('from_location', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='transfers_out', to='stock.stocklocation')),
                ('received_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='received_transfers', to=settings.AUTH_USER_MODEL)),
                ('requested_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='requested_transfers', to=settings.AUTH_USER_MODEL)),
                ('shipped_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='shipped_transfers', to=settings.AUTH_USER_MODEL)),
                ('to_location', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='transfers_in', to='stock.stocklocation')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='StockUnit',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('name', models.CharField(max_length=50)),
                ('short_name', models.CharField(max_length=10)),
                ('unit_type', models.CharField(choices=[('WEIGHT', 'Weight'), ('VOLUME', 'Volume'), ('COUNT', 'Count'), ('LENGTH', 'Length'), ('TIME', 'Time')], max_length=20)),
                ('is_base_unit', models.BooleanField(default=False)),
                ('conversion_factor', models.DecimalField(decimal_places=6, default=1, help_text='Multiply by this factor to convert to base unit', max_digits=15)),
                ('decimal_places', models.PositiveSmallIntegerField(default=2, help_text='Number of decimal places to display for this unit')),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('base_unit', models.ForeignKey(blank=True, help_text='The base unit this unit converts to (e.g. gram for kilogram)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='derived_units', to='stock.stockunit')),
            ],
            options={
                'ordering': ['unit_type', 'name'],
            },
        ),
        migrations.CreateModel(
            name='StockTransferItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('requested_qty', models.DecimalField(decimal_places=4, max_digits=15)),
                ('approved_qty', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('shipped_qty', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('received_qty', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('variance_reason', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('batch', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.stockbatch')),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockitem')),
                ('transfer', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='stock.stocktransfer')),
                ('unit', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit')),
            ],
        ),
        migrations.CreateModel(
            name='StockTransaction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('transaction_number', models.CharField(max_length=50, unique=True)),
                ('movement_type', models.CharField(choices=[('PURCHASE_IN', 'Purchase In'), ('SALE_OUT', 'Sale Out'), ('TRANSFER_IN', 'Transfer In'), ('TRANSFER_OUT', 'Transfer Out'), ('PRODUCTION_IN', 'Production In'), ('PRODUCTION_OUT', 'Production Out'), ('ADJUSTMENT_PLUS', 'Adjustment +'), ('ADJUSTMENT_MINUS', 'Adjustment âˆ’'), ('WASTE', 'Waste'), ('SPOILAGE', 'Spoilage'), ('RETURN_FROM_CUSTOMER', 'Return from Customer'), ('RETURN_TO_SUPPLIER', 'Return to Supplier'), ('COUNT_ADJUSTMENT', 'Count Adjustment'), ('OPENING_BALANCE', 'Opening Balance'), ('RESERVATION', 'Reservation'), ('RESERVATION_RELEASE', 'Reservation Release')], db_index=True, max_length=30)),
                ('quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('base_quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('quantity_before', models.DecimalField(decimal_places=4, max_digits=15)),
                ('quantity_after', models.DecimalField(decimal_places=4, max_digits=15)),
                ('unit_cost', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('total_cost', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('reference_type', models.CharField(blank=True, default='', max_length=50)),
                ('reference_id', models.PositiveIntegerField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('batch', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='transactions', to='stock.stockbatch')),
                ('location', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='transactions', to='stock.stocklocation')),
                ('order', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='stock_transactions', to='main.order')),
                ('production_order', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='stock_transactions', to='stock.productionorder')),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='transactions', to='stock.stockitem')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='stock_transactions', to=settings.AUTH_USER_MODEL)),
                ('transfer', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='stock_transactions', to='stock.stocktransfer')),
                ('unit', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='StockItemUnit',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('is_default', models.BooleanField(default=False)),
                ('conversion_to_base', models.DecimalField(decimal_places=6, help_text='Multiply qty in this unit by this factor to get base unit qty', max_digits=15)),
                ('barcode', models.CharField(blank=True, max_length=100, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='alternative_units', to='stock.stockitem')),
                ('unit', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='stock.stockunit')),
            ],
        ),
        migrations.AddField(
            model_name='stockitem',
            name='base_unit',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='stock_items', to='stock.stockunit'),
        ),
        migrations.CreateModel(
            name='RecipeIngredientSubstitute',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('conversion_note', models.TextField(blank=True, default='')),
                ('priority', models.PositiveSmallIntegerField(default=1)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('recipe_ingredient', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='substitutes', to='stock.recipeingredient')),
                ('substitute_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='substitute_for', to='stock.stockitem')),
                ('unit', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit')),
            ],
            options={
                'ordering': ['priority'],
            },
        ),
        migrations.AddField(
            model_name='recipeingredient',
            name='unit',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit'),
        ),
        migrations.CreateModel(
            name='RecipeByProduct',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('expected_quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('is_waste', models.BooleanField(default=False)),
                ('value_percentage', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('recipe', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='by_products', to='stock.recipe')),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='byproduct_of', to='stock.stockitem')),
                ('unit', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit')),
            ],
        ),
        migrations.AddField(
            model_name='recipe',
            name='output_unit',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit'),
        ),
        migrations.CreateModel(
            name='PurchaseReceivingItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('quantity_received', models.DecimalField(decimal_places=4, max_digits=15)),
                ('batch_number', models.CharField(blank=True, default='', max_length=100)),
                ('expiry_date', models.DateField(blank=True, null=True)),
                ('unit_cost', models.DecimalField(decimal_places=4, max_digits=15)),
                ('quality_status', models.CharField(choices=[('PASSED', 'Passed'), ('FAILED', 'Failed'), ('PENDING', 'Pending')], default='PASSED', max_length=20)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('po_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='receiving_items', to='stock.purchaseorderitem')),
                ('receiving', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='stock.purchasereceiving')),
                ('batch_created', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.stockbatch')),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockitem')),
                ('unit', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit')),
            ],
        ),
        migrations.AddField(
            model_name='purchaseorderitem',
            name='unit',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit'),
        ),
        migrations.CreateModel(
            name='ProductStockLink',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('link_type', models.CharField(choices=[('RECIPE', 'Recipe'), ('DIRECT_ITEM', 'Direct Item'), ('COMPONENT_BASED', 'Component Based')], max_length=20)),
                ('quantity_per_sale', models.DecimalField(decimal_places=4, default=1, max_digits=15)),
                ('deduct_on_status', models.CharField(choices=[('CREATED', 'Order Created'), ('PREPARING', 'Preparing'), ('READY', 'Ready'), ('PAID', 'Paid')], default='PREPARING', max_length=20)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('product', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='stock_link', to='main.product')),
                ('recipe', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='product_links', to='stock.recipe')),
                ('stock_item', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='product_links', to='stock.stockitem')),
                ('unit', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.stockunit')),
            ],
        ),
        migrations.CreateModel(
            name='ProductionOrderOutput',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('is_primary_output', models.BooleanField(default=True)),
                ('is_byproduct', models.BooleanField(default=False)),
                ('is_waste', models.BooleanField(default=False)),
                ('quality_status', models.CharField(choices=[('PASSED', 'Passed'), ('FAILED', 'Failed'), ('PENDING', 'Pending')], default='PENDING', max_length=20)),
                ('quality_notes', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('production_order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='outputs', to='stock.productionorder')),
                ('batch_created', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.stockbatch')),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockitem')),
                ('unit', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit')),
            ],
        ),
        migrations.CreateModel(
            name='ProductionOrderIngredient',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('planned_quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('actual_quantity', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('variance', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('variance_reason', models.TextField(blank=True, default='')),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('ALLOCATED', 'Allocated'), ('CONSUMED', 'Consumed')], default='PENDING', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('production_order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ingredients', to='stock.productionorder')),
                ('recipe_ingredient', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.recipeingredient')),
                ('batch_used', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.stockbatch')),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockitem')),
                ('unit', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit')),
            ],
        ),
        migrations.AddField(
            model_name='productionorder',
            name='output_unit',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit'),
        ),
        migrations.CreateModel(
            name='ProductComponentStock',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('component_name', models.CharField(max_length=100)),
                ('quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('is_default', models.BooleanField(default=True)),
                ('is_addable', models.BooleanField(default=True)),
                ('is_removable', models.BooleanField(default=True)),
                ('price_modifier', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('product_stock_link', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='components', to='stock.productstocklink')),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockitem')),
                ('unit', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit')),
            ],
        ),
        migrations.AddField(
            model_name='purchaseorder',
            name='supplier',
            field=models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='purchase_orders', to='stock.supplier'),
        ),
        migrations.CreateModel(
            name='SupplierStockItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('supplier_sku', models.CharField(blank=True, default='', max_length=50)),
                ('supplier_name', models.CharField(blank=True, default='', help_text='What the supplier calls this item', max_length=200)),
                ('price', models.DecimalField(decimal_places=4, max_digits=15)),
                ('currency', models.CharField(default='UZS', max_length=3)),
                ('min_order_qty', models.DecimalField(decimal_places=4, default=1, max_digits=15)),
                ('pack_size', models.DecimalField(decimal_places=4, default=1, max_digits=15)),
                ('lead_time_days', models.PositiveIntegerField(blank=True, null=True)),
                ('is_preferred', models.BooleanField(default=False)),
                ('last_price_update', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='suppliers', to='stock.stockitem')),
                ('supplier', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='stock_items', to='stock.supplier')),
                ('unit', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockunit')),
            ],
        ),
        migrations.AddField(
            model_name='purchaseorderitem',
            name='supplier_stock_item',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.supplierstockitem'),
        ),
        migrations.CreateModel(
            name='StockCountItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('system_quantity', models.DecimalField(decimal_places=4, max_digits=15)),
                ('counted_quantity', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('variance', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('variance_percentage', models.DecimalField(blank=True, decimal_places=4, max_digits=8, null=True)),
                ('variance_cost', models.DecimalField(blank=True, decimal_places=4, max_digits=15, null=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('is_adjusted', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('batch', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.stockbatch')),
                ('stock_count', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='items', to='stock.stockcount')),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='+', to='stock.stockitem')),
                ('adjustment_transaction', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.stocktransaction')),
                ('reason_code', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to='stock.variancereasoncode')),
            ],
        ),
        migrations.CreateModel(
            name='StockLevel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('uuid', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('quantity', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('reserved_quantity', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('pending_in_quantity', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('pending_out_quantity', models.DecimalField(decimal_places=4, default=0, max_digits=15)),
                ('last_counted_at', models.DateTimeField(blank=True, null=True)),
                ('last_restocked_at', models.DateTimeField(blank=True, null=True)),
                ('last_movement_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('stock_item', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='stock_levels', to='stock.stockitem')),
                ('location', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='stock_levels', to='stock.stocklocation')),
            ],
            options={
                'unique_together': {('stock_item', 'location')},
            },
        ),
        migrations.AddIndex(
            model_name='stocktransaction',
            index=models.Index(fields=['stock_item', 'created_at'], name='stock_stock_stock_i_5a6f1b_idx'),
        ),
        migrations.AddIndex(
            model_name='stocktransaction',
            index=models.Index(fields=['movement_type', 'created_at'], name='stock_stock_movemen_23ca9c_idx'),
        ),
        migrations.AddIndex(
            model_name='stocktransaction',
            index=models.Index(fields=['reference_type', 'reference_id'], name='stock_stock_referen_6e7e88_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='stockitemunit',
            unique_together={('stock_item', 'unit')},
        ),
        migrations.AlterUniqueTogether(
            name='stockbatch',
            unique_together={('batch_number', 'stock_item')},
        ),
        migrations.AlterUniqueTogether(
            name='supplierstockitem',
            unique_together={('supplier', 'stock_item')},
        ),
    ]
